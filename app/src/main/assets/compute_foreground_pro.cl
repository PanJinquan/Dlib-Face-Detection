CiNkZWZpbmUgY29tcG9uZW50c0NvdW50IDMKLy8jZGVmaW5lIGZpbHRlcldpZHRoIDIwCgoKX19r
ZXJuZWwgdm9pZCBjb21wdXRlRm9yR3JvdW5kUEtlcm5lbChfX2dsb2JhbCB1Y2hhcjQgKnNyY0J1
ZmZlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19nbG9iYWwgZmxvYXQg
KmRzdEJ1ZmZlciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlu
dCB3aWR0aCwgY29uc3QgaW50IGhlaWdodCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgX19nbG9iYWwgZmxvYXQgKmZvcmVncm91bmRHbW1Nb2RlbCwKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgX19nbG9iYWwgZmxvYXQgKmZvcmVncm91bmRHbW1JbnZlcnND
b3YsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fZ2xvYmFsIGZsb2F0ICpm
b3JlZ3JvdW5kR21tQ292RGV0ZXJtcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgX19nbG9iYWwgZmxvYXQgKmJhY2tncm91bmRHbW1Nb2RlbCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgX19nbG9iYWwgZmxvYXQgKmJhY2tncm91bmRHbW1JbnZlckNvdiwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19nbG9iYWwgZmxvYXQgKmJhY2tn
cm91bmRHTU1Db3ZEZXRlcm1zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkK
ewoJZmxvYXQgb3V0cHV0ID0gMC4wZjsKCWZsb2F0IGZvcmVncm91bmRQID0gMC4wZjsKCWZsb2F0
IGJhY2tncm91bmRQID0gMC4wZjsKCQoJaW50IHggPSBnZXRfZ2xvYmFsX2lkKDApOwogICAgaW50
IHkgPSBnZXRfZ2xvYmFsX2lkKDEpOwogICAJaW50IGNlbnRlckluZGV4ID0geSAqIHdpZHRoICsg
eDsKICAgCQogICAJZmxvYXQ0IGN1cnJlbnRQaXhlbCA9IGNvbnZlcnRfZmxvYXQ0KHNyY0J1ZmZl
cltjZW50ZXJJbmRleF0pOwogICAJCiAgIAlmb3IoIGludCBjaSA9IDA7IGNpIDwgY29tcG9uZW50
c0NvdW50OyBjaSsrICkKICAgCXsKICAgCQlmbG9hdCByZXMgPSAwLjBmOwogICAJCQogICAJCWlm
KCBmb3JlZ3JvdW5kR21tTW9kZWxbY2ldID4gMCApCiAgIAkJewogICAJCQlmbG9hdDMgZGlmZiA9
IGN1cnJlbnRQaXhlbC54eXo7CiAgIAkJCS8vZm9yZWdyb3VuZEdtbU1vZGVsW2NvbXBvbmVudHND
b3VudCArIDMqY2ldCgkJCWRpZmYueCAtPSBmb3JlZ3JvdW5kR21tTW9kZWxbY29tcG9uZW50c0Nv
dW50ICsgMypjaSArIDBdOwoJCQlkaWZmLnkgLT0gZm9yZWdyb3VuZEdtbU1vZGVsW2NvbXBvbmVu
dHNDb3VudCArIDMqY2kgKyAxXTsKCQkJZGlmZi56IC09IGZvcmVncm91bmRHbW1Nb2RlbFtjb21w
b25lbnRzQ291bnQgKyAzKmNpICsgMl07CgkJCQoJCQlmbG9hdCBtdWx0ID0gZGlmZi54KihkaWZm
LngqZm9yZWdyb3VuZEdtbUludmVyc0Nvdls5KmNpKzBdICsgZGlmZi55KmZvcmVncm91bmRHbW1J
bnZlcnNDb3ZbOSpjaSsxXSArIGRpZmYueipmb3JlZ3JvdW5kR21tSW52ZXJzQ292WzkqY2krMl0p
CgkJCQkJCSsgZGlmZi55KihkaWZmLngqZm9yZWdyb3VuZEdtbUludmVyc0Nvdls5KmNpKzNdICsg
ZGlmZi55KmZvcmVncm91bmRHbW1JbnZlcnNDb3ZbOSpjaSs0XSArIGRpZmYueipmb3JlZ3JvdW5k
R21tSW52ZXJzQ292WzkqY2krNV0pCgkJCQkJCSsgZGlmZi56KihkaWZmLngqZm9yZWdyb3VuZEdt
bUludmVyc0Nvdls5KmNpKzZdICsgZGlmZi55KmZvcmVncm91bmRHbW1JbnZlcnNDb3ZbOSpjaSs3
XSArIGRpZmYueipmb3JlZ3JvdW5kR21tSW52ZXJzQ292WzkqY2krOF0pOwogICAJCQkKICAgCQkJ
cmVzID0gMS4wZi9zcXJ0KGZvcmVncm91bmRHbW1Db3ZEZXRlcm1zW2NpXSkgKiBleHAoLTAuNWYq
bXVsdCk7CiAgIAkJCS8vcmVzID0gZGlmZi54KmZvcmVncm91bmRHbW1JbnZlcnNDb3ZbOSpjaSsw
XTsKICAgCQl9CiAgIAkJCiAgIAkJZm9yZWdyb3VuZFAgKz0gIGZvcmVncm91bmRHbW1Nb2RlbFtj
aV0gKiByZXM7CiAgIAkgCQogICAJfQogICAJCiAgIAkKICAgCWZvciggaW50IGNpID0gMDsgY2kg
PCBjb21wb25lbnRzQ291bnQ7IGNpKysgKQogICAJewogICAJCWZsb2F0IHJlcyA9IDAuMGY7CiAg
IAkJCiAgIAkJaWYoIGJhY2tncm91bmRHbW1Nb2RlbFtjaV0gPiAwICkKICAgCQl7CiAgIAkJCWZs
b2F0MyBkaWZmID0gY3VycmVudFBpeGVsLnh5ejsKICAgCQkJLy9mb3JlZ3JvdW5kR21tTW9kZWxb
Y29tcG9uZW50c0NvdW50ICsgMypjaV0KCQkJZGlmZi54IC09IGJhY2tncm91bmRHbW1Nb2RlbFtj
b21wb25lbnRzQ291bnQgKyAzKmNpICsgMF07CgkJCWRpZmYueSAtPSBiYWNrZ3JvdW5kR21tTW9k
ZWxbY29tcG9uZW50c0NvdW50ICsgMypjaSArIDFdOwoJCQlkaWZmLnogLT0gYmFja2dyb3VuZEdt
bU1vZGVsW2NvbXBvbmVudHNDb3VudCArIDMqY2kgKyAyXTsKCQkJCgkJCWZsb2F0IG11bHQgPSBk
aWZmLngqKGRpZmYueCpiYWNrZ3JvdW5kR21tSW52ZXJDb3ZbOSpjaSswXSArIGRpZmYueSpiYWNr
Z3JvdW5kR21tSW52ZXJDb3ZbOSpjaSsxXSArIGRpZmYueipiYWNrZ3JvdW5kR21tSW52ZXJDb3Zb
OSpjaSsyXSkKCQkJCQkJKyBkaWZmLnkqKGRpZmYueCpiYWNrZ3JvdW5kR21tSW52ZXJDb3ZbOSpj
aSszXSArIGRpZmYueSpiYWNrZ3JvdW5kR21tSW52ZXJDb3ZbOSpjaSs0XSArIGRpZmYueipiYWNr
Z3JvdW5kR21tSW52ZXJDb3ZbOSpjaSs1XSkKCQkJCQkJKyBkaWZmLnoqKGRpZmYueCpiYWNrZ3Jv
dW5kR21tSW52ZXJDb3ZbOSpjaSs2XSArIGRpZmYueSpiYWNrZ3JvdW5kR21tSW52ZXJDb3ZbOSpj
aSs3XSArIGRpZmYueipiYWNrZ3JvdW5kR21tSW52ZXJDb3ZbOSpjaSs4XSk7CiAgIAkJCQogICAJ
CQlyZXMgPSAxLjBmL3NxcnQoYmFja2dyb3VuZEdNTUNvdkRldGVybXNbY2ldKSAqIGV4cCgtMC41
ZiptdWx0KTsKICAgCQkKICAgCQl9CiAgIAkJCiAgIAkJYmFja2dyb3VuZFAgKz0gYmFja2dyb3Vu
ZEdtbU1vZGVsW2NpXSAqIHJlczsKICAgCSAJCiAgIAl9CiAgIAkKICAgCW91dHB1dCA9IGZvcmVn
cm91bmRQLyhmb3JlZ3JvdW5kUCArIGJhY2tncm91bmRQICsgMC4wMDAwMSk7CiAgIAkKCS8vZHN0
QnVmZmVyW2NlbnRlckluZGV4XSA9IGJhY2tncm91bmRHTU1Db3ZEZXRlcm1zWzBdOwoJLy9kc3RC
dWZmZXJbY2VudGVySW5kZXhdID0gY3VycmVudFBpeGVsLngvMjU1LjBmOwoJLy9kc3RCdWZmZXJb
Y2VudGVySW5kZXhdID0gZm9yZWdyb3VuZFA7Cglkc3RCdWZmZXJbY2VudGVySW5kZXhdID0gb3V0
cHV0Owp9CgpfX2tlcm5lbCB2b2lkIGNvbXB1dGVLbWVhbnNEaXN0S2VybmVsKF9fZ2xvYmFsIHVj
aGFyNCAqc3JjQnVmZmVyLAoJCQkJCQkJCQkJX19nbG9iYWwgdWNoYXIgKmRzdEJ1ZmZlciwgCgkJ
CQkJCQkJCQljb25zdCBpbnQgd2lkdGgsIGNvbnN0IGludCBoZWlnaHQsCgkJCQkJCQkJCQlfX2ds
b2JhbCBmbG9hdCAqY2VudGVycykKewoJaW50IHggPSBnZXRfZ2xvYmFsX2lkKDApOwogICAgaW50
IHkgPSBnZXRfZ2xvYmFsX2lkKDEpOwogICAJaW50IGNlbnRlckluZGV4ID0geSAqIHdpZHRoICsg
eDsKICAgCQogICAJZmxvYXQ0IGN1cnJlbnRQaXhlbCA9IGNvbnZlcnRfZmxvYXQ0KHNyY0J1ZmZl
cltjZW50ZXJJbmRleF0pOwogICAJCiAgIAlmbG9hdCBsZWFzdERpc3QgPSBGTFRfTUFYOwogICAg
dWNoYXIgY2xvc2VzdENlbnRyb2lkID0gMDsKICAgCQogICAJZm9yKGludCBpID0gMDsgaSA8IGNv
bXBvbmVudHNDb3VudDsgaSsrKQogICAJewogICAJCWZsb2F0IGJEaXN0ID0gY3VycmVudFBpeGVs
LnggLSBjZW50ZXJzW2kqMyArIDBdOwogICAJCWZsb2F0IGdEaXN0ID0gY3VycmVudFBpeGVsLnkg
LSBjZW50ZXJzW2kqMyArIDFdOwogICAJCWZsb2F0IHJEaXN0ID0gY3VycmVudFBpeGVsLnogLSBj
ZW50ZXJzW2kqMyArIDJdOwogICAJCQogICAJCWZsb2F0IGRpc3QgPSAoYkRpc3QgKiBiRGlzdCkg
KyAoZ0Rpc3QgKiBnRGlzdCkgKyAockRpc3QgKiByRGlzdCk7CiAgIAkJCiAgIAkJbGVhc3REaXN0
ID0gZm1pbiggbGVhc3REaXN0LCBkaXN0ICk7CiAgIAkJCiAgIAkJY2xvc2VzdENlbnRyb2lkID0g
KGxlYXN0RGlzdCA9PSBkaXN0KSA/IGkgOiBjbG9zZXN0Q2VudHJvaWQ7CiAgIAl9CiAgIAkKICAg
CQogICAJZHN0QnVmZmVyW2NlbnRlckluZGV4XSA9IGNsb3Nlc3RDZW50cm9pZDsKICAgCQp9Cgpf
X2tlcm5lbCB2b2lkIGNvbXB1dGVEaWxhdGVLZXJuZWwoX19nbG9iYWwgdWNoYXIgKnNyY0J1ZmZl
ciwKCQkJCQkJCQkJX19nbG9iYWwgdWNoYXIgKmRzdEJ1ZmZlciwKCQkJCQkJCQkJY29uc3QgaW50
IHdpZHRoLCBjb25zdCBpbnQgaGVpZ2h0LAoJCQkJCQkJCQlfX2dsb2JhbCB1Y2hhciAqc2VCdWZm
ZXIsCgkJCQkJCQkJCWNvbnN0IGludCByYWRpdXMpCnsKCWludCB4ID0gZ2V0X2dsb2JhbF9pZCgw
KTsKICAgIGludCB5ID0gZ2V0X2dsb2JhbF9pZCgxKTsKICAgCWludCBjZW50ZXJJbmRleCA9IHkg
KiB3aWR0aCArIHg7CiAgIAkKICAgCWludCBmaWx0ZXJXaWR0aCA9IHJhZGl1czsKICAgCQogICAJ
dWNoYXIgb3V0X3ZhbHVlID0gMDsKICAgCQogICAJCiAgIAkvL2lmICggKHggPj0gZmlsdGVyV2lk
dGgpICYmICh4IDwgKHdpZHRoIC0gZmlsdGVyV2lkdGgpKSAmJiAgICAgLy9hdm9pZCByZWFkaW5n
IG91dHNpZGUgb2YgYnVmZmVyCiAgICAgIC8vICAgKHkgPj0gZmlsdGVyV2lkdGgpICYmICh5IDwg
KGhlaWdodCAtIGZpbHRlcldpZHRoKSkgKQogICAgewogICAgCXVjaGFyIGNlbnRlclBpeGVsID0g
c3JjQnVmZmVyW2NlbnRlckluZGV4XTsKICAgIAkKICAgIAlib29sIG91dGVyQnJlYWsgPSBmYWxz
ZTsKICAgIAlmb3IgKGludCB5eT0tZmlsdGVyV2lkdGg7IHl5PD1maWx0ZXJXaWR0aCAmJiAhb3V0
ZXJCcmVhazsgeXkrKykKCQl7CgoJCQlmb3IgKGludCB4eD0tZmlsdGVyV2lkdGg7IHh4PD1maWx0
ZXJXaWR0aDsgeHgrKykKCQkJewoJCQkJaW50IHRoaXNJbmRleCA9ICh5K3l5KSAqIHdpZHRoICsg
KHgreHgpOyAKCQkJCWludCBtYXNrSW5kZXggPSAoeXkrcmFkaXVzKSAqIChyYWRpdXMqMisxKSAr
ICh4eCtyYWRpdXMpOwoJCQkJCgkJCQl1Y2hhciBjdXJyZW50UGl4ZWw7CgkJCQlpZiggeCt4eCA8
IDAgfHwgeCt4eCA+PSB3aWR0aCB8fCB5K3l5IDwgMCB8fCB5K3l5ID49IGhlaWdodCkKCQkJCXsK
CQkJCQljdXJyZW50UGl4ZWwgPSAwOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCWN1cnJlbnRQ
aXhlbCA9IHNyY0J1ZmZlclt0aGlzSW5kZXhdOwoJCQkJfQoJCQkJCgkJCQl1Y2hhciBtYXNrID0g
c2VCdWZmZXJbbWFza0luZGV4XTsKCQkJCQkKCQkJCWlmKDI1NSA9PSBjdXJyZW50UGl4ZWwgJiYg
MSA9PSBtYXNrKQoJCQkJewoJCQkJCW91dF92YWx1ZSA9IDI1NTsKCQkJCQlvdXRlckJyZWFrID0g
dHJ1ZTsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0KICAgIAkKICAgIH0KICAgCQogICAJZHN0
QnVmZmVyW2NlbnRlckluZGV4XSA9IG91dF92YWx1ZTsKfQoK